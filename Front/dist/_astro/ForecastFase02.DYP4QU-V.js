import{j as h}from"./jsx-runtime.CLpGMVip.js";import{r as x}from"./index.B017X-4C.js";import{_ as te,a as re,b as W,F as ae}from"./ForecastHeader.BFcXe338.js";import{s as ne}from"./SonnerToastProvider.ws9DQA-d.js";import"./_commonjsHelpers.CqkleIqs.js";import"./index.MqFlFA97.js";function k({initialValue:r,onChange:e}){const[n,o]=x.useState(!1),[s,d]=x.useState(r);function S(){o(!1),e(s)}return n?h.jsx("input",{autoFocus:!0,value:s,onChange:w=>d(w.target.value),onBlur:S,className:"border w-full border-red-500 rounded-md p-1 focus:outline-none focus:ring-2 focus:ring-red-300"}):h.jsx("div",{onClick:()=>o(!0),className:"cursor-pointer",children:s})}const oe=[{accessorKey:"cliente_t2",header:"Cliente T2",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"cliente_t2",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"estoque_t2",header:"Estoque T2",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"estoque_t2",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"em_transito_dist",header:"Em transito Dist",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"em_transito_dist",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"total_estoque_t2",header:"Total estoque T2",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"total_estoque_t2",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"media_vendas_13w",header:"Media Vendas 13W",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"media_vendas_13w",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"woh_t2",header:"WOH T2",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"woh_t2",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"fcst_frozen_si",header:"Fcst Frozen SI",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"fcst_frozen_si",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"realizado_si",header:"Realizado SI",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"realizado_si",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"pct_fcst_si",header:"% Fcst SI",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"pct_fcst_si",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"realizado_si_ly",header:"Realizado SI LY",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"realizado_si_ly",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"pct_yoy",header:"% YoY",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"pct_yoy",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"fcst_frozen_so",header:"Fcst Frozen SO",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"fcst_frozen_so",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"realizado_so",header:"Realizado SO",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"realizado_so",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"pct_fcst_so",header:"% Fcst SO",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"pct_fcst_so",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"realizado_so_ly",header:"Realizado SO LY",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"realizado_so_ly",d)};return h.jsx(k,{initialValue:o,onChange:s})}},{accessorKey:"pct_yoy_so",header:"% YoY",enableSorting:!0,cell:({row:r,getValue:e,table:n})=>{const o=e(),s=d=>{n.options.meta?.updateData(r.index,"pct_yoy_so",d)};return h.jsx(k,{initialValue:o,onChange:s})}}];function se({rows:r=5,columns:e=5}){const n=Array.from({length:r}),o=Array.from({length:e});return h.jsx("div",{className:"space-y-2",children:n.map((s,d)=>h.jsx("div",{className:"flex space-x-2",children:o.map((S,w)=>h.jsx("div",{className:"flex-1 h-8 bg-gray-300 rounded animate-pulse"},w))},d))})}function ie(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,te(r,e)}var V=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function le(r,e){return!!(r===e||V(r)&&V(e))}function ce(r,e){if(r.length!==e.length)return!1;for(var n=0;n<r.length;n++)if(!le(r[n],e[n]))return!1;return!0}function K(r,e){e===void 0&&(e=ce);var n,o=[],s,d=!1;function S(){for(var w=[],b=0;b<arguments.length;b++)w[b]=arguments[b];return d&&n===this&&e(w,o)||(s=r.apply(this,w),d=!0,n=this,o=w),s}return S}var de=typeof performance=="object"&&typeof performance.now=="function",$=de?function(){return performance.now()}:function(){return Date.now()};function q(r){cancelAnimationFrame(r.id)}function ue(r,e){var n=$();function o(){$()-n>=e?r.call(null):s.id=requestAnimationFrame(o)}var s={id:requestAnimationFrame(o)};return s}var F=-1;function U(r){if(r===void 0&&(r=!1),F===-1||r){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",document.body.appendChild(e),F=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return F}var E=null;function H(r){if(r===void 0&&(r=!1),E===null||r){var e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";var o=document.createElement("div"),s=o.style;return s.width="100px",s.height="100px",e.appendChild(o),document.body.appendChild(e),e.scrollLeft>0?E="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?E="negative":E="positive-ascending"),document.body.removeChild(e),E}return E}var he=150,fe=function(e,n){return e};function pe(r){var e,n=r.getItemOffset,o=r.getEstimatedTotalSize,s=r.getItemSize,d=r.getOffsetForIndexAndAlignment,S=r.getStartIndexForOffset,w=r.getStopIndexForStartIndex,b=r.initInstanceProps,D=r.shouldResetStyleCacheOnItemSizeChange,I=r.validateProps;return e=function(_){ie(C,_);function C(p){var t;return t=_.call(this,p)||this,t._instanceProps=b(t.props,W(t)),t._outerRef=void 0,t._resetIsScrollingTimeoutId=null,t.state={instance:W(t),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof t.props.initialScrollOffset=="number"?t.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},t._callOnItemsRendered=void 0,t._callOnItemsRendered=K(function(c,l,f,y){return t.props.onItemsRendered({overscanStartIndex:c,overscanStopIndex:l,visibleStartIndex:f,visibleStopIndex:y})}),t._callOnScroll=void 0,t._callOnScroll=K(function(c,l,f){return t.props.onScroll({scrollDirection:c,scrollOffset:l,scrollUpdateWasRequested:f})}),t._getItemStyle=void 0,t._getItemStyle=function(c){var l=t.props,f=l.direction,y=l.itemSize,i=l.layout,a=t._getItemStyleCache(D&&y,D&&i,D&&f),u;if(a.hasOwnProperty(c))u=a[c];else{var g=n(t.props,c,t._instanceProps),v=s(t.props,c,t._instanceProps),z=f==="horizontal"||i==="horizontal",T=f==="rtl",B=z?g:0;a[c]=u={position:"absolute",left:T?void 0:B,right:T?B:void 0,top:z?0:g,height:z?"100%":v,width:z?v:"100%"}}return u},t._getItemStyleCache=void 0,t._getItemStyleCache=K(function(c,l,f){return{}}),t._onScrollHorizontal=function(c){var l=c.currentTarget,f=l.clientWidth,y=l.scrollLeft,i=l.scrollWidth;t.setState(function(a){if(a.scrollOffset===y)return null;var u=t.props.direction,g=y;if(u==="rtl")switch(H()){case"negative":g=-y;break;case"positive-descending":g=i-f-y;break}return g=Math.max(0,Math.min(g,i-f)),{isScrolling:!0,scrollDirection:a.scrollOffset<g?"forward":"backward",scrollOffset:g,scrollUpdateWasRequested:!1}},t._resetIsScrollingDebounced)},t._onScrollVertical=function(c){var l=c.currentTarget,f=l.clientHeight,y=l.scrollHeight,i=l.scrollTop;t.setState(function(a){if(a.scrollOffset===i)return null;var u=Math.max(0,Math.min(i,y-f));return{isScrolling:!0,scrollDirection:a.scrollOffset<u?"forward":"backward",scrollOffset:u,scrollUpdateWasRequested:!1}},t._resetIsScrollingDebounced)},t._outerRefSetter=function(c){var l=t.props.outerRef;t._outerRef=c,typeof l=="function"?l(c):l!=null&&typeof l=="object"&&l.hasOwnProperty("current")&&(l.current=c)},t._resetIsScrollingDebounced=function(){t._resetIsScrollingTimeoutId!==null&&q(t._resetIsScrollingTimeoutId),t._resetIsScrollingTimeoutId=ue(t._resetIsScrolling,he)},t._resetIsScrolling=function(){t._resetIsScrollingTimeoutId=null,t.setState({isScrolling:!1},function(){t._getItemStyleCache(-1,null)})},t}C.getDerivedStateFromProps=function(t,c){return me(t,c),I(t),null};var m=C.prototype;return m.scrollTo=function(t){t=Math.max(0,t),this.setState(function(c){return c.scrollOffset===t?null:{scrollDirection:c.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},m.scrollToItem=function(t,c){c===void 0&&(c="auto");var l=this.props,f=l.itemCount,y=l.layout,i=this.state.scrollOffset;t=Math.max(0,Math.min(t,f-1));var a=0;if(this._outerRef){var u=this._outerRef;y==="vertical"?a=u.scrollWidth>u.clientWidth?U():0:a=u.scrollHeight>u.clientHeight?U():0}this.scrollTo(d(this.props,t,c,i,this._instanceProps,a))},m.componentDidMount=function(){var t=this.props,c=t.direction,l=t.initialScrollOffset,f=t.layout;if(typeof l=="number"&&this._outerRef!=null){var y=this._outerRef;c==="horizontal"||f==="horizontal"?y.scrollLeft=l:y.scrollTop=l}this._callPropsCallbacks()},m.componentDidUpdate=function(){var t=this.props,c=t.direction,l=t.layout,f=this.state,y=f.scrollOffset,i=f.scrollUpdateWasRequested;if(i&&this._outerRef!=null){var a=this._outerRef;if(c==="horizontal"||l==="horizontal")if(c==="rtl")switch(H()){case"negative":a.scrollLeft=-y;break;case"positive-ascending":a.scrollLeft=y;break;default:var u=a.clientWidth,g=a.scrollWidth;a.scrollLeft=g-u-y;break}else a.scrollLeft=y;else a.scrollTop=y}this._callPropsCallbacks()},m.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&q(this._resetIsScrollingTimeoutId)},m.render=function(){var t=this.props,c=t.children,l=t.className,f=t.direction,y=t.height,i=t.innerRef,a=t.innerElementType,u=t.innerTagName,g=t.itemCount,v=t.itemData,z=t.itemKey,T=z===void 0?fe:z,B=t.layout,j=t.outerElementType,Y=t.outerTagName,G=t.style,J=t.useIsScrolling,Q=t.width,P=this.state.isScrolling,R=f==="horizontal"||B==="horizontal",X=R?this._onScrollHorizontal:this._onScrollVertical,A=this._getRangeToRender(),Z=A[0],ee=A[1],L=[];if(g>0)for(var O=Z;O<=ee;O++)L.push(x.createElement(c,{data:v,key:T(O,v),index:O,isScrolling:J?P:void 0,style:this._getItemStyle(O)}));var M=o(this.props,this._instanceProps);return x.createElement(j||Y||"div",{className:l,onScroll:X,ref:this._outerRefSetter,style:re({position:"relative",height:y,width:Q,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:f},G)},x.createElement(a||u||"div",{children:L,ref:i,style:{height:R?"100%":M,pointerEvents:P?"none":void 0,width:R?M:"100%"}}))},m._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var t=this.props.itemCount;if(t>0){var c=this._getRangeToRender(),l=c[0],f=c[1],y=c[2],i=c[3];this._callOnItemsRendered(l,f,y,i)}}if(typeof this.props.onScroll=="function"){var a=this.state,u=a.scrollDirection,g=a.scrollOffset,v=a.scrollUpdateWasRequested;this._callOnScroll(u,g,v)}},m._getRangeToRender=function(){var t=this.props,c=t.itemCount,l=t.overscanCount,f=this.state,y=f.isScrolling,i=f.scrollDirection,a=f.scrollOffset;if(c===0)return[0,0,0,0];var u=S(this.props,a,this._instanceProps),g=w(this.props,u,a,this._instanceProps),v=!y||i==="backward"?Math.max(1,l):1,z=!y||i==="forward"?Math.max(1,l):1;return[Math.max(0,u-v),Math.max(0,Math.min(c-1,g+z)),u,g]},C}(x.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var me=function(e,n){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,n.instance},ge=pe({getItemOffset:function(e,n){var o=e.itemSize;return n*o},getItemSize:function(e,n){var o=e.itemSize;return o},getEstimatedTotalSize:function(e){var n=e.itemCount,o=e.itemSize;return o*n},getOffsetForIndexAndAlignment:function(e,n,o,s,d,S){var w=e.direction,b=e.height,D=e.itemCount,I=e.itemSize,_=e.layout,C=e.width,m=w==="horizontal"||_==="horizontal",p=m?C:b,t=Math.max(0,D*I-p),c=Math.min(t,n*I),l=Math.max(0,n*I-p+I+S);switch(o==="smart"&&(s>=l-p&&s<=c+p?o="auto":o="center"),o){case"start":return c;case"end":return l;case"center":{var f=Math.round(l+(c-l)/2);return f<Math.ceil(p/2)?0:f>t+Math.floor(p/2)?t:f}case"auto":default:return s>=l&&s<=c?s:s<l?l:c}},getStartIndexForOffset:function(e,n){var o=e.itemCount,s=e.itemSize;return Math.max(0,Math.min(o-1,Math.floor(n/s)))},getStopIndexForStartIndex:function(e,n,o){var s=e.direction,d=e.height,S=e.itemCount,w=e.itemSize,b=e.layout,D=e.width,I=s==="horizontal"||b==="horizontal",_=n*w,C=I?D:d,m=Math.ceil((C+o-_)/w);return Math.max(0,Math.min(S-1,n+m-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});function we({columns:r,data:e,rowHeight:n=40,height:o=400,renderRow:s}){const d=({index:S,style:w})=>h.jsx("div",{style:w,children:s(e[S],S)});return h.jsx(ge,{height:o,itemCount:e.length,itemSize:n,width:"100%",children:d})}const N=[{width:"80px",headerBg:"#f0f0f0"},{width:"200px",headerBg:"#e0e0e0"},{width:"120px",headerBg:"#d1d1d1"},{width:"120px",headerBg:"#d2d2d2"},{width:"120px",headerBg:"#d3d3d3"},{width:"500px",headerBg:"#d4d4d4"},{width:"300px",headerBg:"#d5d5d5"},{width:"300px",headerBg:"#d6d6d6"},{width:"300px",headerBg:"#d7d7d7"},{width:"300px",headerBg:"#d8d8d8"},{width:"300px",headerBg:"#d9d9d9"},{width:"300px",headerBg:"#dadada"},{width:"300px",headerBg:"#dbdbdb"},{width:"300px",headerBg:"#dcdcdc"},{width:"300px",headerBg:"#dddddd"},{width:"300px",headerBg:"#dedede"},{width:"300px",headerBg:"#dfdfdf"},{width:"300px",headerBg:"#e0e0e0"},{width:"300px",headerBg:"#e1e1e1"},{width:"300px",headerBg:"#e2e2e2"},{width:"300px",headerBg:"#e3e3e3"},{width:"300px",headerBg:"#e4e4e4"},{width:"300px",headerBg:"#e5e5e5"},{width:"300px",headerBg:"#e6e6e6"},{width:"300px",headerBg:"#e7e7e7"},{width:"300px",headerBg:"#e8e8e8"},{width:"300px",headerBg:"#e9e9e9"},{width:"300px",headerBg:"#eaeaea"},{width:"300px",headerBg:"#ebebeb"},{width:"300px",headerBg:"#ececec"},{width:"300px",headerBg:"#e4e4e4"},{width:"300px",headerBg:"#e5e5e5"},{width:"300px",headerBg:"#e6e6e6"},{width:"300px",headerBg:"#e7e7e7"},{width:"300px",headerBg:"#e8e8e8"},{width:"300px",headerBg:"#e9e9e9"},{width:"300px",headerBg:"#eaeaea"},{width:"300px",headerBg:"#ebebeb"},{width:"300px",headerBg:"#ececec"},{width:"300px",headerBg:"#e4e4e4"},{width:"300px",headerBg:"#e5e5e5"},{width:"300px",headerBg:"#e6e6e6"},{width:"300px",headerBg:"#e7e7e7"},{width:"300px",headerBg:"#e8e8e8"},{width:"300px",headerBg:"#e9e9e9"},{width:"300px",headerBg:"#eaeaea"},{width:"300px",headerBg:"#ebebeb"}];function ye({columns:r,data:e,cardTitle:n,refetchData:o,search:s}){const[d,S]=x.useState([]),[w,b]=x.useState({row:0,col:0}),[D,I]=x.useState(null),_=x.useRef(null);x.useEffect(()=>{S([...e])},[e]);const C=r.map((i,a)=>({...i,width:i.width||N[a]&&N[a].width||"150px",headerBg:i.headerBg||N[a]&&N[a].headerBg||"gray"})),m=C.map(i=>i.width).join(" "),p=C.reduce((i,a)=>{const u=parseInt(a.width,10);return i+(isNaN(u)?150:u)},0);x.useEffect(()=>{if(!_.current)return;const i=`[data-row-index='${w.row}'][data-col-index='${w.col}']`,a=_.current.querySelector(i);a&&a.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})},[w]);const t=i=>{if(i.target.tagName.toLowerCase()==="input"){i.key==="Escape"&&(I(null),_.current?.focus());return}if(!D&&i.key.length===1&&!i.ctrlKey&&!i.metaKey&&!i.altKey){i.preventDefault();const a=C[w.col].accessorKey;I({row:w.row,col:w.col,key:a}),c(w.row,a,i.key);return}b(a=>{let u=a.row,g=a.col;const v=d.length,z=C.length;switch(i.key){case"ArrowRight":a.col<z-1&&(g=a.col+1),i.preventDefault();break;case"ArrowLeft":a.col>0&&(g=a.col-1),i.preventDefault();break;case"ArrowDown":a.row<v-1&&(u=a.row+1),i.preventDefault();break;case"ArrowUp":a.row>0&&(u=a.row-1),i.preventDefault();break;case"Tab":g=a.col<z-1?a.col+1:0,g===0&&a.row<v-1&&(u=a.row+1),i.preventDefault();break;default:return a}return{row:u,col:g}})},c=(i,a,u)=>{S(g=>{const v=[...g];return v[i]={...v[i],[a]:u,isDirty:!0},v})},l=async()=>{const i=d.filter(u=>u.isDirty);if(i.length===0){console.log("Nenhum registro modificado para salvar.");return}const a=localStorage.getItem("token");if(!a){console.error("Token não encontrado. Faça login novamente.");return}try{const u=await fetch("https://api.logihub.space/api/update-forecast",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({records:i})});if(!u.ok)throw new Error("Erro ao salvar os dados");const g=await u.json();console.log("Dados salvos com sucesso:",g),ne("Dados salvos com sucesso!"),S(v=>v.map(z=>({...z,isDirty:!1}))),o&&o()}catch(u){console.error("Erro:",u)}};x.useEffect(()=>{_.current?.focus()},[]);const f=h.jsx("div",{className:"grid border-b",style:{width:p,gridTemplateColumns:m},children:C.map((i,a)=>h.jsx("div",{className:"p-2 text-center font-bold border break-words whitespace-normal",style:{backgroundColor:i.headerBg,color:"black"},children:typeof i.header=="function"?i.header():i.header},a))}),y=(i,a)=>h.jsx("div",{className:"grid border-b bg-gray-200",style:{width:p,gridTemplateColumns:m},children:C.map((u,g)=>{const v=w.row===a&&w.col===g,z=D&&D.row===a&&D.col===g&&D.key===u.accessorKey,T=i[u.accessorKey];return h.jsx("div",{"data-row-index":a,"data-col-index":g,className:`p-2 border break-words whitespace-normal text-sm cursor-pointer ${v?"bg-gray-800 text-gray-50":"text-gray-800"}`,onClick:()=>b({row:a,col:g}),onDoubleClick:()=>I({row:a,col:g,key:u.accessorKey}),children:z?h.jsx("input",{type:"text",value:T,onChange:B=>c(a,u.accessorKey,B.target.value),onBlur:()=>{I(null),_.current?.focus()},onKeyDown:B=>{B.key==="Enter"?(B.preventDefault(),I(null),b(j=>({...j,row:j.row<d.length-1?j.row+1:j.row})),_.current?.focus()):B.key==="Escape"&&(B.preventDefault(),I(null),_.current?.focus())},className:"w-full h-full p-0 m-0 bg-gray-600 text-white border-0 focus:outline-none text-sm",autoFocus:!0}):T},g)})});return h.jsxs("div",{className:"p-4 space-y-4 cursor-pointer",style:{outline:"none"},tabIndex:0,onKeyDown:t,children:[h.jsxs("div",{className:"flex flex-row items-center justify-between",children:[h.jsx("div",{className:"flex flex-col",children:h.jsx("h1",{className:"text-2xl font-bold leading-none text-gray-900 sm:text-3xl dark:text-white",children:n})}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("input",{type:"text",placeholder:"Buscar na tabela...",value:s,onChange:i=>{},className:"max-w-sm border p-2 rounded-md"}),h.jsx("button",{onClick:l,className:"bg-blue-500 text-white p-2 rounded-md",children:"Save"})]})]}),h.jsx("div",{ref:_,className:"overflow-auto border rounded",style:{maxHeight:"600px"},children:h.jsxs("div",{style:{width:p},children:[f,h.jsx(we,{columns:C,data:d,rowHeight:40,height:400,renderRow:y})]})})]})}function Ie(){x.useRef(null);const r=x.useRef(null),[e,n]=x.useState(0),[o,s]=x.useState(!0),[d,S]=x.useState([]),[w,b]=x.useState([]);x.useEffect(()=>{r.current&&n(r.current.offsetWidth)},[]),x.useEffect(()=>{I().then(m=>{if(!m||!m.columns||!m.rows){console.error("Erro: resposta da API não tem colunas ou linhas",m);return}const p=_(m.columns),t=C(m.rows,p);S(p),b(t),s(!1)}).catch(m=>console.error("Erro ao carregar dados do servidor:",m))},[]);const D=async()=>{const m=localStorage.getItem("token");try{const p=await fetch("https://api.logihub.space/api/forecast-data",{headers:{Authorization:`Bearer ${m}`}});if(!p.ok)throw new Error(`Erro na API: ${p.statusText}`);const t=await p.json(),c=_(t.columns),l=C(t.rows,c);S(c),b(l)}catch(p){console.error("Erro ao carregar dados do servidor:",p),S([]),b([])}};x.useEffect(()=>{D()},[]);const I=async()=>{const m=localStorage.getItem("token");try{const p=await fetch("https://api.logihub.space/api/forecast-data",{headers:{Authorization:`Bearer ${m}`}});if(!p.ok)throw new Error(`Erro na API: ${p.statusText}`);return await p.json()}catch(p){return console.error("Erro ao buscar dados do servidor:",p),{columns:[],rows:[]}}},_=m=>!m||!Array.isArray(m)?(console.error("Erro: serverCols inválido",m),[]):m.map(t=>{const c=t.key.trim().toLowerCase(),l=oe.find(f=>f.accessorKey.trim().toLowerCase()===c);return l?{...l,header:t.name||l.header}:{accessorKey:t.key,header:t.name||t.key}}),C=(m,p)=>m.map((t,c)=>{let l={id:t.id||c+1};return p.forEach(({accessorKey:f})=>{const y=f.trim().toLowerCase(),i=Object.keys(t).find(a=>a.trim().toLowerCase()===y);if(i){let a=t[i];!isNaN(a)&&a!==null&&a!==""&&(a=Number(a)),l[f]=a}else l[f]=null}),l});return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"p-5 mt-5 bg-[#1f2937] border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800",children:h.jsx(ae,{dataState:w,setDataState:b})}),h.jsx("div",{className:"p-5 mt-5 bg-[#1f2937] border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 sm:p-6 dark:bg-gray-800",children:o?h.jsx(se,{rows:5,columns:w[0]?Object.keys(w[0]).length:5}):h.jsx(ye,{columns:d,data:w})})]})}export{Ie as default};
