import{j as e}from"./jsx-runtime.CLpGMVip.js";import{r as n}from"./index.BL7xzsR_.js";const f=({files:x,onDelete:h})=>{const[p,m]=n.useState(""),[o,d]=n.useState(1),c=5,u=x.filter(r=>r.spreadsheetName.toLowerCase().includes(p.toLowerCase())),g=u.length,i=Math.ceil(g/c),t=(o-1)*c,s=u.slice(t,t+c),l=r=>{m(r.target.value),d(1)},a=r=>{r<1||r>i||d(r)};return e.jsxs("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:[e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"pb-4 bg-white dark:bg-gray-900",children:[e.jsx("label",{htmlFor:"table-search",className:"sr-only",children:"Search"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("div",{className:"absolute inset-y-0 rtl:inset-r-0 start-0 flex items-center ps-3 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})})}),e.jsx("input",{type:"text",id:"table-search",className:"block pt-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Search for spreadsheets",value:p,onChange:l})]})]})}),e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"checkbox-all-search",type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("label",{htmlFor:"checkbox-all-search",className:"sr-only",children:"checkbox"})]})}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Spreadsheet name"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Upload by"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Upload date"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Download"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Delete"})]})}),e.jsx("tbody",{children:s.length>0?s.map(r=>e.jsxs("tr",{className:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx("td",{className:"w-4 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:`checkbox-table-search-${r.id}`,type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("label",{htmlFor:`checkbox-table-search-${r.id}`,className:"sr-only",children:"checkbox"})]})}),e.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",children:r.spreadsheetName}),e.jsx("td",{className:"px-6 py-4",children:r.uploadBy}),e.jsx("td",{className:"px-6 py-4",children:r.uploadDate}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("a",{href:`https://api.logihub.space/api/download/${r.id}`,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-green-600 dark:text-green-500 hover:underline",children:"â†“"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>h(r.id),className:"font-medium text-red-600 dark:text-red-500 hover:underline",children:"X"})})]},r.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"No data found"})})})]}),i>1&&e.jsxs("nav",{className:"flex items-center flex-wrap md:flex-row justify-between pt-4","aria-label":"Table navigation",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400 mb-4 md:mb-0 block md:inline",children:["Showing ",t+1,"-",Math.min(t+c,g)," of ",g]}),e.jsxs("ul",{className:"inline-flex -space-x-px rtl:space-x-reverse text-sm h-8",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>a(o-1),disabled:o===1,className:"flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 rounded-s-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:"Previous"})}),Array.from({length:i},(r,b)=>e.jsx("li",{children:e.jsx("button",{onClick:()=>a(b+1),className:`flex items-center justify-center px-3 h-8 leading-tight ${o===b+1?"text-blue-600 bg-blue-50 border-blue-300 hover:bg-blue-100 hover:text-blue-700 dark:border-gray-700 dark:bg-gray-700 dark:text-white":"text-gray-500 bg-white border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"}`,children:b+1})},b)),e.jsx("li",{children:e.jsx("button",{onClick:()=>a(o+1),disabled:o===i,className:"flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 rounded-e-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:"Next"})})]})]})]})};function y(x){return x.replace(/-\d+(?=\.)/,"")}function w(){const[x,h]=n.useState([]),[p,m]=n.useState(!1),[o,d]=n.useState(null),c=async()=>{try{const t=await fetch("https://api.logihub.space/api/files");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const l=(await t.json()).map(a=>({id:a.id,spreadsheetName:y(a.plan_name),uploadBy:a.user,uploadDate:new Date(a.created_at).toLocaleString("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}));h(l)}catch(t){console.error("Erro ao buscar arquivos:",t)}};n.useEffect(()=>{c()},[]);const u=async t=>{const s=new FormData;s.append("planilha",t);const l=localStorage.getItem("token");try{const a=await fetch("https://api.logihub.space/api/upload",{method:"POST",body:s,headers:{Authorization:`Bearer ${l}`}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const r=await a.json();return console.log("Upload realizado com sucesso:",r),r}catch(a){throw console.error("Erro ao enviar o arquivo para a API:",a),a}},g=async t=>{const s=t.target.files[0];if(s){m(!0),d(null);try{const l=await u(s),a={id:l.id,spreadsheetName:y(l.plan_name),uploadBy:l.user,uploadDate:new Date(l.created_at).toLocaleString("pt-BR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})};h(r=>[...r,a]),d("Upload realizado com sucesso!")}catch{d("Erro no upload do arquivo!")}finally{m(!1)}}},i=async t=>{try{const s=await fetch(`https://api.logihub.space/api/files/${t}`,{method:"DELETE"});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);h(l=>l.filter(a=>a.id!==t))}catch(s){console.error("Erro ao excluir arquivo:",s)}};return e.jsxs("div",{className:"px-4 pt-6",children:[e.jsxs("div",{className:"sm:px-8 md:px-8 lg:px-8 xl:px-8 2xl:px-8",children:[e.jsx("h1",{className:"text-white text-4xl sm:pl-2 md:pl-10 lg:pl-10 xl:pl-0 pt-10",children:"Media Center"}),e.jsx("p",{className:"text-white my-5 text-sm sm:pl-2 md:pl-10 lg:pl-10 xl:pl-0",children:"Upload and manage your media content"}),e.jsx("p",{className:"text-white my-5 text-sm sm:pl-2 md:pl-10 lg:pl-10 xl:pl-0",children:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Necessitatibus architecto soluta officia dicta porro autem doloremque iure, minima reiciendis delectus ex blanditiis expedita, corporis repellendus perferendis ipsum id? Itaque, nobis."})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"w-full flex flex-col my-10 sm:pl-2 md:pl-10 lg:pl-10 xl:pl-8 sm:pr-2 md:pr-10 lg:pr-10 xl:pr-10",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{htmlFor:"dropzone-file",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-gray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600",children:[e.jsx("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:p?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500"}),e.jsx("p",{className:"text-blue-500 mt-2",children:"Carregando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-8 h-8 mb-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"CSV, XLS or XLSX (MAX. 10MB)"})]})}),e.jsx("input",{id:"dropzone-file",type:"file",accept:".csv, .xls, .xlsx",className:"hidden",onChange:g})]})}),o&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:o.includes("sucesso")?"text-green-500":"text-red-500",children:o})})]}),e.jsx("div",{className:"w-full sm:px-8 md:px-8 lg:px-8 xl:px-8 2xl:px-8",children:e.jsx(f,{files:x,onDelete:i})})]})]})}export{w as default};
